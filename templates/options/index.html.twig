{% extends 'base.html.twig' %}

{% block title %}Options
{% endblock %}

{% block body %}

  <h1 style="font-family:Arial, sans-serif; margin-bottom:15px; color:#333;">Options</h1>

  <!-- Formulaire de recherche et filtrage -->
  <form method="get" action="{{ path('app_options_index') }}" style="background:#fff; padding:10px; border:1px solid #ccc; margin-bottom:20px;">
    <div>
      <!-- Champ texte pour rechercher par nom -->
      <label for="name" style="display:block; margin:5px 0;">Rechercher :</label>
      <input
        type="text"
        id="name"
        name="name"
        value="{{ app.request.get('name') }}"
        style="padding:4px; border:1px solid #ccc; border-radius:3px; width:220px;"
      >
    </div>

    <div style="margin-top:10px;">
      <!-- Liste déroulante pour filtrer par type -->
      <label for="type" style="display:block; margin:5px 0;">Type :</label>
      <select id="type" name="type" style="padding:6px 8px; border:1px solid #ccc; border-radius:3px; width:240px; background:#fff;">

        <option value="">-- Tous les types --</option>

        <!-- Liste des types -->
        {% set types = ['Mobilier', 'Technologie', 'Confort', 'Confort physique', 'Accessibilité', 'Éclairage', 'Acoustique'] %}
        {% for type in types %}
          <!-- option d’un menu déroulant qui coche automatiquement la bonne option selon ce qui est déjà choisi -->
          <option value="{{ type }}" {% if app.request.get('type') == type %} selected {% endif %}>{{ type }}</option>
        {% endfor %}
      </select>
    </div>

    <!-- Boutons recherche et reset -->
    <div>
      <button type="submit" style="display:inline-block; margin-top:10px; padding:6px 10px; border:1px solid #007bff; border-radius:3px; background:#007bff; color:#fff; cursor:pointer;">
        Rechercher
      </button>
      <a href="{{ path('app_options_index') }}" style="display:inline-block; margin-top:10px; padding:6px 10px; border:1px solid #6c757d; border-radius:3px; background:#6c757d; color:#fff; text-decoration:none;">
        Réinitialiser
      </a>
    </div>
  </form>

  <!-- Tableau listant toutes les options -->
  <table class="table" style="width:100%; border-collapse:collapse; background:#fff;">
    <thead>
      <tr>
        <th style="border:1px solid #ccc; padding:8px; background:#eee;">Identifiant</th>
        <th style="border:1px solid #ccc; padding:8px; background:#eee;">Nom</th>
        <th style="border:1px solid #ccc; padding:8px; background:#eee;">Description</th>
        <th style="border:1px solid #ccc; padding:8px; background:#eee;">Type</th>
        <th style="border:1px solid #ccc; padding:8px; background:#eee;">Actions</th>
      </tr>
    </thead>
    <tbody>

      <!-- On fait une boucle : pour chaque élément de la liste options, on exécute le code à l’intérieur.
      Pour chaque option, crée une ligne de tableau » -->
      {% for option in options %}
        <tr style="border:1px solid #ccc;">

          <td style="border:1px solid #ccc; padding:8px;">{{ option.id }}</td>


          <td style="border:1px solid #ccc; padding:8px;">{{ option.name }}</td>

          <td style="border:1px solid #ccc; padding:8px;">{{ option.description }}</td>

          <td style="border:1px solid #ccc; padding:8px;">{{ option.type }}</td>

          <!-- Actions : afficher et modifier -->
          <td style="border:1px solid #ccc; padding:8px; text-align:center;">
            <div style="display:flex; justify-content:center; gap:10px;">
              <a href="{{ path('app_options_show', {'id': option.id}) }}" style="display:inline-block; padding:6px 12px; background:#007bff; color:#fff; border-radius:3px; text-decoration:none;">
                Afficher
              </a>
              <a href="{{ path('app_options_edit', {'id': option.id}) }}" style="display:inline-block; padding:6px 12px; background:#ffc107; color:#000; border-radius:3px; text-decoration:none;">
                Modifier
              </a>
            </div>
          </td>
        </tr>
      {% else %}
        <!-- Message si aucune option trouvée -->
        <tr>
          <td colspan="5" style="text-align:center; padding:10px; color:#555;">Aucun enregistrement trouvé</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Lien pour créer une nouvelle option -->
  <a href="{{ path('app_options_new') }}" style="display:inline-block; margin-top:15px; padding:6px 12px; background:#28a745; color:#fff; border-radius:3px; text-decoration:none;">
    Créer une nouvelle option
  </a>
	<!-- Lien pour créer une nouvelle option -->
	<a href="{{ path('app_options_new') }}">Create new</a>

	{# <!-- Pagination -->
	<div class="d-flex">
		{% if page > 1 %}
			<a href="{{ path('app_options_index', {page: page - 1}) }}" class="btn btn-secondary"> Précédente</a>
		{% endif %}

		<span> {{ page }} | {{ maxPage }}</span>

		{% if page < maxPage %}
			<a href="{{ path('app_options_index', {page: page + 1}) }}" class="btn btn-secondary"> Suivante</a>
		{% endif %}
	</div> #}

{# Nouveau bloc Pagination (conserve les filtres name/type) #}  {#AJOUTER PAR ODILE#}
{% set q = {
  name: app.request.get('name'),
  type: app.request.get('type')
} %}

<div class="d-flex" style="gap:10px; align-items:center; margin-top:10px;">
  {% if page > 1 %}
    <a href="{{ path('app_options_index', q|merge({page: page - 1})) }}" class="btn btn-secondary">Précédente</a>
  {% endif %}

  <span>{{ page }} / {{ maxPage }}</span>

  {% if page < maxPage %}
    <a href="{{ path('app_options_index', q|merge({page: page + 1})) }}" class="btn btn-secondary">Suivante</a>
  {% endif %}
</div> 

{% endblock %}
